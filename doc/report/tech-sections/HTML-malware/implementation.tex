
\subsection{Implementation}
The fact that there is an unclear definition of a malicious webpage makes the implementation of a malware detection system quite challenging. 	  
	

\subsubsection{Frequency of the keyword}
 
In this approach HTML malware detection takes a URL and a keyword as an input. The HTML crawler scans the main webpage and counts the frequency of the given keyword in that webpage. Also, the crawler scans the contents of the webpage for all the hyperlinks in the main webpage. The scanner then computes the ratio as showed below;

Ratio = Total number of keywords within the main page/ Total number of keywords in the inner web page 

There are three possible ratio result as shown below. 

Case (1): Ratio = 0

The zero ratio indicates the keyword does not exist in the main web page. Therefore the attackers used, a trendy keyword in the components of the given URL to misdirect the user to the malicious webpage

Case (2): Ratio = infinity

According to the ratio equation, there is not any instance of a given keyword in the web page of the inner hyperlinks. Therefore, the contents of the inner hyperlink web page are not relevant to the contents of the main web page. Hence, the given URL is deemed malicious.

Case (3): Ratio >= 1

That means the number of trendy keyword appears in the main page is more than or equal to the total number of trendy keyword in the web page inner links. In the other words, the contents of the inner links web page is less relevant to the contents of the main web page. In this case the given URL has identified as a malicious URL. 

Case (4): 0 < Ratio < 1

In this case, there are arguments on the ratio. If the ratio is closer to zero that means the number of keywords appear in the web page are belong to inner hyperlinks are a lot more than the number of the keywords on the main page. Hence, the smaller ratio indicates the higher probability that a given URL is benign. The similar discussion is valid on the bigger ratio (ratios are closer to one). The greater ratio shows higher probability that the given URL is malicious. 

\paragraph{} 
With this approach, there is a risk that malware writer inserted many instances of trendy-term in the web page of the inner hyperlink and add hyperlinks in the more depth. For example, there are hyperlinks in the main page, after going to the webpage of the inner hyperlink (depth 2) there are also hyperlinks in the web page of the inner hyperlink (depth 3). However, this process has to end at some point and there is webpage with no inner link at the end. To avoid this problem, there is iteration for the finding and checking the webpage of the inner hyperlink. Hence, the ratio might does not show the malicious web page at few first iteration but after checking the last inner hyperlinks the requirements of case (2) will satisfy and the given URL will identify as malicious. Adapting this method has helped to overcome the major problem for designing HTML malware scanner, because it is independent of the malware definition. In additions, the method is fairly fast.  
